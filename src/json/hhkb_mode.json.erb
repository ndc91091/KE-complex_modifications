<%
    remap_source_keys = [
        'i', 'o', 'p'
    ];
    remap_dest_keys = [
        'f13', 'f14', 'f15'
    ];
    manipulators = each_key(
        source_keys_list: remap_source_keys,
        dest_keys_list: remap_dest_keys,
        from_mandatory_modifiers: ["fn"],
        as_json: true
    );
%>
{
    "title": "Happy Hacking Keyboard Compatible Mode (rev 2)",
    "rules": [
        {
            "description": "HHKB Arrow Mode (fn + semicolon/slash/open_bracket/quote to arrow keys, etc)",
            "manipulators": [

                <%# change fn + semicolon/slash/open_bracket/quote to arrow keys %>
                {
                    "type": "basic",
                    "from": <%= from("semicolon", ["fn"], ["caps_lock", "option", "command", "shift", "control"]) %>,
                    "to": <%= to([["left_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("slash", ["fn"], ["caps_lock", "option", "command", "shift", "control"]) %>,
                    "to": <%= to([["down_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("open_bracket", ["fn"], ["caps_lock", "option", "command", "shift", "control"]) %>,
                    "to": <%= to([["up_arrow"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("quote", ["fn"], ["caps_lock", "option", "command", "shift", "control"]) %>,
                    "to": <%= to([["right_arrow"]]) %>
                },

                <%# change fn + l/period/k/comma to page_up/page_down/home/end %>
                {
                    "type": "basic",
                    "from": <%= from("l", ["fn"], ["caps_lock", "option"]) %>,
                    "to": <%= to([["page_up"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("period", ["fn"], ["caps_lock", "option"]) %>,
                    "to": <%= to([["page_down"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("k", ["fn"], ["caps_lock"]) %>,
                    "to": <%= to([["home"]]) %>
                },
                {
                    "type": "basic",
                    "from": <%= from("comma", ["fn"], ["caps_lock"]) %>,
                    "to": <%= to([["end"]]) %>
                }
            ]
        },
        {
            "description": "HHKB Media Key Mode (fn + asdf to Volume down/up/mute, eject) (rev 2)",
            "manipulators": [
                {
                    "type": "basic",
                    "from": <%= from("a", ["fn"], ["any"]) %>,
                    "to": [ { "consumer_key_code": "volume_decrement" } ]
                },
                {
                    "type": "basic",
                    "from": <%= from("s", ["fn"], ["any"]) %>,
                    "to": [ { "consumer_key_code": "volume_increment" } ]
                },
                {
                    "type": "basic",
                    "from": <%= from("d", ["fn"], ["any"]) %>,
                    "to": [ { "consumer_key_code": "mute" } ]
                },
                {
                    "type": "basic",
                    "from": <%= from("f", ["fn"], ["any"]) %>,
                    "to": [ { "consumer_key_code": "eject" } ]
                }
            ]
        },
        {
            "description": "Map fn + i, o, p  to F13, F14, F15.",
            "manipulators": <%= manipulators %>
        }
    ]
}
